<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ThÃªm cá»™t Base64 vÃ  Táº£i CSV</title>
</head>
<body>
  <h2>Chá»n file CSV</h2>
  <input type="file" id="csvFile" accept=".csv" />
  <button onclick="handleCSV()">Xá»­ lÃ½ vÃ  Táº£i xuá»‘ng</button>

  <script>
    function encodeUnicodeToBase64(str) {
      return btoa(unescape(encodeURIComponent(str)));
    }

    function handleCSV() {
      const fileInput = document.getElementById('csvFile');
      const file = fileInput.files[0];
      if (!file) {
        alert("Vui lÃ²ng chá»n file CSV!");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const lines = e.target.result.trim().split(/\r?\n/);
        const header = lines[0].trim();
        const dataLines = lines.slice(1);

        const newLines = [header + ",link web khi mÆ¡Ì€i,LÆ¡Ì€i mÆ¡Ì€i"];

        for (let line of dataLines) {
          const list = line.split(',');
          const name = list[0].trim();
          if (name) {
            var encoded = '';
            var loimoi = '';
            var xungho = '';
            var vaive = '';
            const relate = list[1].trim();
            if(relate === '' || relate === null) {
                encoded = 'BaÌ£n ' + name;
                vaive = 'baÌ£n';
                xungho = 'miÌ€nh';
                loimoi = `
                    Hello báº¡n iu ğŸ¥°

                    Tá»¥i mÃ¬nh cÃ³ má»™t tin vui muá»‘n chia sáº» â€“ bá»n mÃ¬nh sáº¯p vá» chung má»™t nhÃ  rá»“i nÃ¨ â¤ï¸

                    Tá»¥i mÃ¬nh ráº¥t mong báº¡n sáº½ Ä‘áº¿n chung vui trong ngÃ y trá»ng Ä‘áº¡i nÃ y:

                    ğŸ’’ HÃ”N Lá»„:
                    ğŸ“… Thá»i gian: 17h30, ngÃ y 07/05/2025  
                    ğŸ“ Äá»‹a Ä‘iá»ƒm: NO 51 - LK 16 - Dá»c BÃºn 2 - La KhÃª - HÃ  ÄÃ´ng - HÃ  Ná»™i

                    Sá»± cÃ³ máº·t cá»§a báº¡n lÃ  niá»m háº¡nh phÃºc vÃ  vinh háº¡nh lá»›n cá»§a tá»¥i mÃ¬nh!  
                    Mong Ä‘Æ°á»£c gáº·p báº¡n táº¡i buá»•i tiá»‡c nhÃ©! ğŸ’

                    ğŸ‘‰ ThiÃªÌ£p cÆ°Æ¡Ìi miÌ€nh gÆ°Ì‰i baÌ£n taÌ£i: `;
            }else if(relate === '1') {
                encoded = 'Anh ' + name;
                vaive = 'anh';
                xungho = 'em';
                loimoi = `
                    Em chÃ o anh,

                    Em xin phÃ©p Ä‘Æ°á»£c gá»­i Ä‘áº¿n anh lá»i má»i dá»± lá»… cÆ°á»›i cá»§a vá»£ chá»“ng em, Ä‘Æ°á»£c tá»• chá»©c vÃ o thá»i gian sáº¯p tá»›i.  
                    Ráº¥t mong anh dÃ nh chÃºt thá»i gian Ä‘áº¿n chung vui vÃ  chÃºc phÃºc cho vá»£ chá»“ng em trong ngÃ y trá»ng Ä‘áº¡i nÃ y.

                    ğŸ’’ HÃ”N Lá»„:  
                    ğŸ“… Thá»i gian: 17h30, ngÃ y 07/05/2025  
                    ğŸ“ Äá»‹a Ä‘iá»ƒm: NO 51 - LK 16 - Dá»c BÃºn 2 - La KhÃª - HÃ  ÄÃ´ng - HÃ  Ná»™i

                    Thiá»‡p má»i em xin gá»­i kÃ¨m bÃªn dÆ°á»›i.  
                    Sá»± hiá»‡n diá»‡n cá»§a anh lÃ  niá»m vinh háº¡nh lá»›n Ä‘á»‘i vá»›i vá»£ chá»“ng em.

                    ğŸ‘‰ ThiÃªÌ£p cÆ°Æ¡Ìi cuÌ‰a em: `;

            }else if(relate === '2') {
                encoded = 'Em ' + name;
                xungho = 'anh';
                vaive = 'em';
                loimoi = `
                    ChÃ o em,

                    Anh cÃ³ má»™t tin vui muá»‘n chia sáº»: Anh sáº½ tá»• chá»©c lá»… cÆ°á»›i vÃ o thá»i gian sáº¯p tá»›i.  
                    Ráº¥t mong em sáº½ dÃ nh chÃºt thá»i gian Ä‘áº¿n chung vui vÃ  chÃºc phÃºc cho vá»£ chá»“ng anh trong ngÃ y trá»ng Ä‘áº¡i nÃ y.

                    ğŸ’’ HÃ”N Lá»„:  
                    ğŸ“… Thá»i gian: 17h30, ngÃ y 07/05/2025  
                    ğŸ“ Äá»‹a Ä‘iá»ƒm: NO 51 - LK 16 - Dá»c BÃºn 2 - La KhÃª - HÃ  ÄÃ´ng - HÃ  Ná»™i

                    Anh gá»­i kÃ¨m thiá»‡p má»i online bÃªn dÆ°á»›i.  
                    Ráº¥t hy vá»ng sáº½ nháº­n Ä‘Æ°á»£c sá»± hiá»‡n diá»‡n cá»§a em trong buá»•i tiá»‡c hÃ´m Ä‘Ã³.  

                    ThiÃªÌ£p mÆ¡Ì€i cuÌ‰a em anh gÆ°Ì‰i taÌ£i: `;
            }else if(relate === '3') {
                encoded = 'ChiÌ£ ' + name;
                xungho = 'em';
                vaive = 'chiÌ£';
                loimoi = `
                    Em chÃ o chiÌ£,

                    Em xin phÃ©p Ä‘Æ°á»£c gá»­i Ä‘áº¿n chiÌ£ lá»i má»i dá»± lá»… cÆ°á»›i cá»§a vá»£ chá»“ng em, Ä‘Æ°á»£c tá»• chá»©c vÃ o thá»i gian sáº¯p tá»›i.  
                    Ráº¥t mong chiÌ£ dÃ nh chÃºt thá»i gian Ä‘áº¿n chung vui vÃ  chÃºc phÃºc cho vá»£ chá»“ng em trong ngÃ y trá»ng Ä‘áº¡i nÃ y.

                    ğŸ’’ HÃ”N Lá»„:  
                    ğŸ“… Thá»i gian: 17h30, ngÃ y 07/05/2025  
                    ğŸ“ Äá»‹a Ä‘iá»ƒm: NO 51 - LK 16 - Dá»c BÃºn 2 - La KhÃª - HÃ  ÄÃ´ng - HÃ  Ná»™i

                    Thiá»‡p má»i em xin gá»­i kÃ¨m bÃªn dÆ°á»›i.  
                    Sá»± hiá»‡n diá»‡n cá»§a chiÌ£ lÃ  niá»m vinh háº¡nh lá»›n Ä‘á»‘i vá»›i vá»£ chá»“ng em.

                    ğŸ‘‰ ThiÃªÌ£p cÆ°Æ¡Ìi cuÌ‰a em: `;
            }
            const isMarried = list[2].trim();
            if(isMarried === '' || isMarried === null) {
                encoded = encoded + ' vaÌ€ ngÆ°Æ¡Ì€i thÆ°Æ¡ng';
            }else {
                encoded = encoded + ' vaÌ€ gia Ä‘iÌ€nh';
            }
            const linkAC = `https://hoangled13cn5.github.io/married-me?name=${encodeUnicodeToBase64(encoded)}&time=${encodeUnicodeToBase64('17h30')}&date=${encodeUnicodeToBase64('Thá»© 5, ngÃ y 7/5/2025')}&xungho=${encodeUnicodeToBase64('xungho')}&vaive=${encodeUnicodeToBase64('vaive')}`
            const loimoidaydu = `${loimoi}${linkAC}`;
            newLines.push(`${name},${relate},${isMarried},${linkAC},${loimoidaydu}`); 
          }
        }

        const newCsvContent = newLines.join('\n');
        downloadCSV(newCsvContent, 'encoded_names.csv');
      };

      reader.readAsText(file);
    }

    function downloadCSV(content, fileName) {
      const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement("a");
      const url = URL.createObjectURL(blob);
      link.setAttribute("href", url);
      link.setAttribute("download", fileName);
      link.style.display = "none";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
